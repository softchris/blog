




<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="In this article we like to explore forward references. Why they exist and how we can use them.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="thoughtram">
    <title>Forward references in Angular by thoughtram</title>
    <meta name="google-site-verification" content="o9eGPEgIETEqYGombq7NiQuBIB_qa6gz1yAL7PxKyK0">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4D8799">
    <link rel="icon" sizes="192x192" href="/images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="thoughtram">
    <link rel="apple-touch-icon" href="/images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="/images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#4D8799">

    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Forward references in Angular">
    <meta property="og:description" content="In this article we like to explore forward references. Why they exist and how we can use them.">
    <meta property="og:url" content="http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html">
    <meta property="og:site_name" content="Articles by thoughtram">
    <meta property="og:image" content="http://blog.thoughtram.io">
    <meta property="og:publisher" content="http://www.facebook.com/thoughtram">

    <meta property="twitter:card" content="summary">
    <meta property="twitter:title" content="Forward references in Angular">
    <meta property="twitter:site" content="thoughtram Blog">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css" type="text/css">
  </head>
  <body class="sub-site">
    <!-- Add your site or app content here -->

    <!--[if lt IE 10]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <header class="thtrm-header" role="banner">
      <div class="thtrm-header-bar">
        <div class="thtrm-constraint">
          <a href="http://thoughtram.io" class="thtrm-header-logo-link" title="thoughtram.io Start Page"><h1 class="thtrm-header-logo">thoughtram</h1></a>
          <div class="thtrm-header-menu-wrapper">
            <span role="button" tabindex="0" class="thtrm-header-menu-label">Menu</span>
            <ul class="thtrm-header-menu">
              <li><a title="Training" class="thtrm-header-menu-item" href="http://thoughtram.io/training.html">Training</a></li>
              <li><a title="Code Review" class="thtrm-header-menu-item" href="http://thoughtram.io/code-review.html">Code Review</a></li>
              <li><a title="Casts" class="thtrm-header-menu-item " href="http://casts.thoughtram.io">Casts</a></li>
              <li><a title="Blog" class="thtrm-header-menu-item" href="/">Blog</a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <main role="main" class="thtrm-main">
    <div class="thtrm-banner" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%), url('/images/banner/fallback.jpeg');">
        <hgroup class="thtrm-banner-container">
          <div class="thtrm-constraint thtrm-constraint--slim">
            <h2 class="thtrm-banner-text">Forward references in Angular</h2>
            <span>by <a href="http://twitter.com/" title="Christoph Burgdorf on Twitter">Christoph Burgdorf</a> on Sep 3, 2015, last updated on Dec 16, 2016<br>9 minute read</span>

          </div>
        </hgroup>
      </div>
      <div class="thtrm-constraint thtrm-constraint--slim">

        <div class="thtrm-article">
          <section class="thtrm-ad thtrm-section thtrm-section--is-promo is-sticky">
  <img width="100" src="/images/angular2-shield-inverse.svg">
  <h3 class="thtrm-section-headline">Angular Master Class in Denmark</h3>
  <p class="thtrm-section-text">Join our upcoming public training! </p>
  <a href="https://www.eventbrite.de/e/angular-master-class-denmark-tickets-34271504994?aff=blogAd" title="Angular Master Class in Denmark" id="event-cta" class="thtrm-layout-divider-cta">Get a ticket <strong>&rarr;</strong></a>
</section>


          
          <p style="background-color: lightgoldenrodyellow; border: solid 2px #f9dead; padding: 1em; text-align: center; border-radius: 0.3em;">Contents are based on Angular version <strong>>= 2.x</strong> unless explicitely stated differently.</p>
          

          <p>In our article on <a href="/angular/2015/05/18/dependency-injection-in-angular-2.html">Dependency Injection in Angular</a> we explored what dependency injection actually is, and how it is implemented in the Angular framework. If you haven’t read that article yet, I highly recommend you doing so, since this article is based on it.</p>

<p>In a another article we even learned about <a href="/angular/2015/08/20/host-and-visibility-in-angular-2-dependency-injection.html"><strong>host</strong> and <strong>visibility of dependencies</strong></a> as another aspect of Angular’s DI system. But that doesn’t mean that we’ve already discovered all features of the machinery yet. In this article we’ll take a look at <strong>forward references</strong>. Another tiny, yet useful feature of the DI system in Angular.</p>

<div class="thtrm-toc is-sticky">
  <h3 class="no_toc" id="table-of-contents">TABLE OF CONTENTS</h3>
<ul id="markdown-toc">
  <li><a href="#understanding-the-problem" id="markdown-toc-understanding-the-problem">Understanding the problem</a></li>
  <li><a href="#classes-arent-hoisted-for-a-good-reason" id="markdown-toc-classes-arent-hoisted-for-a-good-reason">Classes aren’t hoisted for a good reason</a></li>
  <li><a href="#so-the-class-must-always-be-declared-before-its-usage" id="markdown-toc-so-the-class-must-always-be-declared-before-its-usage">So the class must always be declared before it’s usage?</a></li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ul>

</div>

<h2 id="understanding-the-problem">Understanding the problem</h2>

<p>As a small recap, here we have an <code>AppComponent</code> that relies on DI to get a <code>NameService</code> injected. As we are using TypeScript, all we need to do is to annotate our constructor parameter <code>nameService</code> with the <code>NameService</code> type. This gives Angular all the relevant info to correctly resolve the dependency at runtime.</p>

<p><strong>app.ts</strong></p>

<div class="highlight"><pre><code class="language-ts" data-lang="ts"><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">NameService</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'./name.service'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'my-app'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Favourite framework: {{ name }}&lt;/h1&gt;'</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">AppComponent</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">nameService</span><span class="err">:</span> <span class="nx">NameService</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">nameService</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p><strong>nameService.ts</strong></p>

<div class="highlight"><pre><code class="language-ts" data-lang="ts"><span class="k">export</span> <span class="kr">class</span> <span class="nx">NameService</span> <span class="p">{</span>
  <span class="nx">getName</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Angular"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>This works well, but let’s see what happens when we inline the contents of <code>nameService.ts</code> directly in <code>app.ts</code>. In this case, you probably wouldn’t want to do that but bear with me as I’m trying to make my point.</p>

<div class="highlight"><pre><code class="language-ts" data-lang="ts"><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'my-app'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Favourite framework: {{ name }}&lt;/h1&gt;'</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">AppComponent</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">nameService</span><span class="err">:</span> <span class="nx">NameService</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">nameService</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">NameService</span> <span class="p">{</span>
  <span class="nx">getName</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Angular"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>When we try to run this code we notice that it stopped working. In my case, I wasn’t even able to get an error reported to the console which I assume boils down to some glitch with debugging TypeScript code with source maps. Anyways, when we use the debuggers “Pause on exceptions” feature we can follow the rabbit into it’s hole somewhere deep down inside the Angular framework.</p>

<p><code>Cannot resolve all parameters for AppComponent(undefined). Make sure they all have valid type or annotations</code>.</p>

<p>Ok, this gives us a little hint. It seems <code>NameService</code> is undefined in the constructor of <code>AppComponent</code>. This makes sense if you look at the flow of the code because we already used <code>NameService</code> in the constructor of <code>AppComponent</code> before we actually declared it. But on the other hand, using regular ES5 constructor functions that would be totally valid because function declarations get hoisted to the top by the JavaScript interpreter behind the scenes. And then, aren’t ES2015 classes just sugar on top of regular ES5 functions after all?</p>

<p>Let’s see what happens when we move <code>NameService</code> to the top so that it’s declared before it’s first usage.</p>

<div class="highlight"><pre><code class="language-ts" data-lang="ts"><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span> <span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">NameService</span> <span class="p">{</span>
  <span class="nx">getName</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Angular"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'my-app'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Favourite framework: {{ name }}&lt;/h1&gt;'</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">AppComponent</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="nx">nameService</span><span class="err">:</span> <span class="nx">NameService</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">nameService</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>Ok, this seems to work just fine. But why doesn’t the JavaScript interpreter do that for us in the first place as it does for regular ES5 constructor functions?</p>

<h2 id="classes-arent-hoisted-for-a-good-reason">Classes aren’t hoisted for a good reason</h2>

<p>Let’s step back from Angular for a moment in order to understand the bare mechanics of the JavaScript language in this regard.</p>

<p>The JavaScript interpreter doesn’t hoist class declarations because it may lead to unsound behavior when we have a class that uses the <code>extend</code> keyword to inherit from something. In particular, when it inherits from an expression which is absolutely valid.</p>

<p>Consider this ES6 code:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span> <span class="p">{</span>

<span class="p">}</span>

<span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>This alerts <code>moving</code> just fine because what happens behind the scenes is that the JavaScript interpreter restructures the code to this.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">defaultMove</span><span class="p">,</span> <span class="nx">dog</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span> <span class="p">{</span>

<span class="p">}</span>

<span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>However, try making <code>Animal</code> an expression rather than a function declaration.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span> <span class="p">{</span>

<span class="p">}</span>

<span class="kd">let</span> <span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">let</span> <span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>Again, this will be hoisted but now it becomes this.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">Animal</span><span class="p">,</span> <span class="nx">defaultMove</span><span class="p">,</span> <span class="nx">dog</span><span class="p">;</span>

<span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span> <span class="p">{</span>

<span class="p">}</span>

<span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>At the point where <code>class Dog extends Animal</code> is interpreted <code>Animal</code> is actually undefined and we get an error. We can easily fix that by moving the <code>Animal</code> expression before the declaration of <code>Dog</code>.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span><span class="p">{</span>

<span class="p">}</span>

<span class="kd">let</span> <span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>This works just fine again. Now think about what <em>would</em> actually happen if the JavaScript interpreter hoisted <code>Dog</code> just like a regular ES5 constructor function? We would end up with this code:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">let</span> <span class="nx">Animal</span><span class="p">,</span> <span class="nx">defaultMove</span><span class="p">,</span> <span class="nx">dog</span><span class="p">;</span>

<span class="c1">// Dog is now hoisted above `Animal = function Anim...`</span>
<span class="kr">class</span> <span class="nx">Dog</span> <span class="kr">extends</span> <span class="nx">Animal</span><span class="p">{</span>

<span class="p">}</span>

<span class="nx">Animal</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">Animal</span> <span class="p">{</span>
  <span class="k">this</span><span class="p">.</span><span class="nx">move</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="nx">defaultMove</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">defaultMove</span> <span class="o">=</span> <span class="s2">"moving"</span><span class="p">;</span>

<span class="nx">dog</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dog</span><span class="p">();</span>
<span class="nx">dog</span><span class="p">.</span><span class="nx">move</span><span class="p">();</span></code></pre></div>

<p>Now that <code>Dog</code> is hoisted to the top the code breaks at the moment where the <code>extends Animal</code> is interpreted because <code>Animal</code> is <code>undefined</code> at that moment. The important thing to note here is that the <code>extends</code> part has to be evaluated at the right point in time. Therefore classes aren’t hoisted.</p>

<h2 id="so-the-class-must-always-be-declared-before-its-usage">So the class must always be declared before it’s usage?</h2>

<p>Ok, now that we understood <em>why</em> classes aren’t hoisted what does that mean for our earlier Angular example where we had to move the <code>NameService</code> to the very top? Is this the only way to get things working?</p>

<p>Turns out there is a solution we can reach for. Instead of annotating our <code>nameService</code> parameter with the <code>NameService</code> type which we learned evaluates to <code>undefined</code> at this point in time, we can use the <code>@Inject</code> annotation in conjunction with the <code>forwardRef</code> function as demonstrated here.</p>

<div class="highlight"><pre><code class="language-ts" data-lang="ts"><span class="k">import</span> <span class="p">{</span><span class="nx">Component</span><span class="p">,</span> <span class="nx">Inject</span><span class="p">,</span> <span class="nx">forwardRef</span><span class="p">}</span> <span class="k">from</span> <span class="s1">'@angular/core'</span><span class="p">;</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'my-app'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="s1">'&lt;h1&gt;Favourite framework: {{ name }}&lt;/h1&gt;'</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">AppComponent</span> <span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="kr">string</span><span class="p">;</span>

  <span class="kd">constructor</span><span class="p">(</span><span class="err">@</span><span class="nx">Inject</span><span class="p">(</span><span class="nx">forwardRef</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">NameService</span><span class="p">))</span> <span class="nx">nameService</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">nameService</span><span class="p">.</span><span class="nx">getName</span><span class="p">();</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">class</span> <span class="nx">NameService</span> <span class="p">{</span>
  <span class="nx">getName</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="s2">"Angular"</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>What <code>forwardRef</code> does is, it takes a function as a parameter that returns a class. And because this function isn’t immediately called but instead is called <em>after</em> <code>NameService</code> is declared it is safe to return <code>NameService</code> from it. In other words: At the point where <code>() =&gt; NameService</code> runs <code>NameService</code> isn’t undefined anymore.</p>

<h2 id="conclusion">Conclusion</h2>

<p>The described scenario isn’t something that one has to deal with too often. This only becomes a problem when we want to have a class injected that we created in the same file. Most of the time we have one class per file and import the classes that we need at the very top of the file so we won’t actually suffer from the fact that classes aren’t hoisted.</p>


          




        </div>

        <div class="thtrm-subscriber">
  <h3>Get updates on new articles and trainings.</h3>
  <p>Join over 1400 other developers who get our content first.</p>
  <form action="//thoughtram.us8.list-manage.com/subscribe/post?u=dfbb1507fbced5a20d9dc5698&amp;id=731f22cdca" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate>
    <label for="mce-EMAIL"></label>
    <input type="email" value="" name="EMAIL" placeholder="Your email address..." required>
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_dfbb1507fbced5a20d9dc5698_731f22cdca" tabindex="-1" value=""></div>
    <input type="submit" value="Subscribe" name="subscribe" class="thtrm-cta thtrm-cta--small">
  </form>
</div>



        <div class="thtrm-social-links">
            <!-- Sharingbutton Facebook -->
            <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" aria-label="Share on Facebook">
              <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M18.768,7.465H14.5V5.56c0-0.896,0.594-1.105,1.012-1.105s2.988,0,2.988,0V0.513L14.171,0.5C10.244,0.5,9.5,3.438,9.5,5.32 v2.145h-3v4h3c0,5.212,0,12,0,12h5c0,0,0-6.85,0-12h3.851L18.768,7.465z"/>
                    </g>
                </svg>
                </div>Share on Facebook</div>
            </a>

            <!-- Sharingbutton Twitter -->
            <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Forward%20references%20in%20Angular&amp;url=http://blog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" aria-label="Share on Twitter">
              <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M23.444,4.834c-0.814,0.363-1.5,0.375-2.228,0.016c0.938-0.562,0.981-0.957,1.32-2.019c-0.878,0.521-1.851,0.9-2.886,1.104 C18.823,3.053,17.642,2.5,16.335,2.5c-2.51,0-4.544,2.036-4.544,4.544c0,0.356,0.04,0.703,0.117,1.036 C8.132,7.891,4.783,6.082,2.542,3.332C2.151,4.003,1.927,4.784,1.927,5.617c0,1.577,0.803,2.967,2.021,3.782 C3.203,9.375,2.503,9.171,1.891,8.831C1.89,8.85,1.89,8.868,1.89,8.888c0,2.202,1.566,4.038,3.646,4.456 c-0.666,0.181-1.368,0.209-2.053,0.079c0.579,1.804,2.257,3.118,4.245,3.155C5.783,18.102,3.372,18.737,1,18.459 C3.012,19.748,5.399,20.5,7.966,20.5c8.358,0,12.928-6.924,12.928-12.929c0-0.198-0.003-0.393-0.012-0.588 C21.769,6.343,22.835,5.746,23.444,4.834z"/>
                    </g>
                </svg>
                </div>Share on Twitter</div>
            </a>

            <!-- Sharingbutton Google+ -->
            <a class="resp-sharing-button__link" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.thoughtram.io/angular/2015/09/03/forward-references-in-angular-2.html" target="_blank" aria-label="Share on Google+">
              <div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M11.366,12.928c-0.729-0.516-1.393-1.273-1.404-1.505c0-0.425,0.038-0.627,0.988-1.368 c1.229-0.962,1.906-2.228,1.906-3.564c0-1.212-0.37-2.289-1.001-3.044h0.488c0.102,0,0.2-0.033,0.282-0.091l1.364-0.989 c0.169-0.121,0.24-0.338,0.176-0.536C14.102,1.635,13.918,1.5,13.709,1.5H7.608c-0.667,0-1.345,0.118-2.011,0.347 c-2.225,0.766-3.778,2.66-3.778,4.605c0,2.755,2.134,4.845,4.987,4.91c-0.056,0.22-0.084,0.434-0.084,0.645 c0,0.425,0.108,0.827,0.33,1.216c-0.026,0-0.051,0-0.079,0c-2.72,0-5.175,1.334-6.107,3.32C0.623,17.06,0.5,17.582,0.5,18.098 c0,0.501,0.129,0.984,0.382,1.438c0.585,1.046,1.843,1.861,3.544,2.289c0.877,0.223,1.82,0.335,2.8,0.335 c0.88,0,1.718-0.114,2.494-0.338c2.419-0.702,3.981-2.482,3.981-4.538C13.701,15.312,13.068,14.132,11.366,12.928z M3.66,17.443 c0-1.435,1.823-2.693,3.899-2.693h0.057c0.451,0.005,0.892,0.072,1.309,0.2c0.142,0.098,0.28,0.192,0.412,0.282 c0.962,0.656,1.597,1.088,1.774,1.783c0.041,0.175,0.063,0.35,0.063,0.519c0,1.787-1.333,2.693-3.961,2.693 C5.221,20.225,3.66,19.002,3.66,17.443z M5.551,3.89c0.324-0.371,0.75-0.566,1.227-0.566l0.055,0 c1.349,0.041,2.639,1.543,2.876,3.349c0.133,1.013-0.092,1.964-0.601,2.544C8.782,9.589,8.363,9.783,7.866,9.783H7.865H7.844 c-1.321-0.04-2.639-1.6-2.875-3.405C4.836,5.37,5.049,4.462,5.551,3.89z"/>
                        <polygon points="23.5,9.5 20.5,9.5 20.5,6.5 18.5,6.5 18.5,9.5 15.5,9.5 15.5,11.5 18.5,11.5 18.5,14.5 20.5,14.5 20.5,11.5  23.5,11.5   "/>
                    </g>
                </svg>
                </div>Share on Google+</div>
            </a>
        </div>

        <h3 class="thtrm-section-headline thtrm-section-headline--with-margin">Author</h3>
        <div class="thtrm-article-author">
          <span class="thtrm-article-author-avatar"><img src="/images/author-christoph.jpg" alt="Picture of Christoph Burgdorf"></span>
          <div class="thtrm-article-author-matter">
            <h4 class="thtrm-article-author-name">Christoph Burgdorf</h4>
            <p class="thtrm-article-author-text">Christoph began programming at the age of 10. He is the creator of the Nickel.rs web framework and a contributor of the AngularJS project. Christoph is also part of the Angular Docs Authoring team.</p>
            <p>
              <a class="thtrm-article-author-cta thtrm-article-author-cta-twitter" href="http://twitter.com/cburgdorf" title="Christoph Burgdorf on Twitter">Twitter</a>
              <a class="thtrm-article-author-cta" href="http://github.com/cburgdorf" title="Christoph Burgdorf on GitHub">GitHub</a>
            </p>
          </div>
        </div>
      </div>

      <div class="thtrm-constraint">

        
        <h4 class="thtrm-section-headline thtrm-section-headline--with-big-margin thtrm-section-headline--centered">Related Posts</h4>
        <ul class="thtrm-three-column-list thtrm-three-column-list--with-padding">
        
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/05/23/custom-themes-with-angular-material.html" title="Custom themes with Angular Material">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/custom-themes-with-angular-material.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Custom themes with Angular Material</h3>
                <p>Angular Material offers great theming capabilities for both, built-in and custom themes. In this article we'll explore how to make...</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/05/08/angular-master-class-redux-and-ngrx.html" title="Angular Master Class - Redux and ngrx">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/ngrx_slide_logo.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Angular Master Class - Redux and ngrx</h3>
                <p>Today we're super excited to announce that we finished working on our new Angular Master Class courseware. Read on for...</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/27/three-things-you-didnt-know-about-the-async-pipe.html" title="Three things you didn't know about the AsyncPipe">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/three-things-about-the-async-pipe.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Three things you didn't know about the AsyncPipe</h3>
                <p>This article explains three lesser known features of the AsyncPipe that help us to write better async code.</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/21/using-zones-in-angular-for-better-performance.html" title="Using Zones in Angular for better performance">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/using-zones-in-angular-for-better-performance.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Using Zones in Angular for better performance</h3>
                <p>In this article we'll take a look at how to use Zone APIs to improve our app's performance!</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/02/making-your-angular-app-fast.html" title="Making your Angular apps fast">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/angular-performance-tips.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Making your Angular apps fast</h3>
                <p>In this article we discuss tips and tricks to make Angular blazingly fast!</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2016/12/27/angular-2-advance-testing-with-custom-matchers.html" title="Testing Angular Directives with Custom Matchers">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/testing-directives-with-custom-matchers2.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Testing Angular Directives with Custom Matchers</h3>
                <p>Deliver terse, DRY, self-documenting unit tests with Angular using custom Jasmine Matchers and  Helper functions.</p>
              </div>
            </a>
          </li>
        
        
        </ul>
        

      
      <h4 class="thtrm-section-headline thtrm-section-headline--with-big-margin thtrm-section-headline--centered">You might also be interested in</h4>
      <ul class="thtrm-three-column-list thtrm-three-column-list--with-padding">
        
        <li>
          <div class="thtrm-article-card thtrm-article-card--with-border" title="Exploring Angular 2 - Article Series">
            <div class="thtrm-article-card-content ">
              <h3>Exploring Angular 2 - Article Series</h3>
              <a class="thtrm-cta thtrm-cta--small" href="/exploring-angular-2" title="Exploring Angular 2 - Article Series">Read more</a>
            </div>
          </div>
        </li>
        
        <li>
          <div class="thtrm-article-card thtrm-article-card--with-border" title="Dependency Injection in Angular 2">
            <div class="thtrm-article-card-content ">
              <h3>Dependency Injection in Angular 2</h3>
              <a class="thtrm-cta thtrm-cta--small" href="/angular/2015/05/18/dependency-injection-in-angular-2.html" title="Dependency Injection in Angular 2">Read more</a>
            </div>
          </div>
        </li>
        
        <li>
          <div class="thtrm-article-card thtrm-article-card--with-border" title="Host and Visibility in Angular 2's Dependency Injection">
            <div class="thtrm-article-card-content ">
              <h3>Host and Visibility in Angular 2's Dependency Injection</h3>
              <a class="thtrm-cta thtrm-cta--small" href="/angular/2015/08/20/host-and-visibility-in-angular-2-dependency-injection.html" title="Host and Visibility in Angular 2's Dependency Injection">Read more</a>
            </div>
          </div>
        </li>
        
      </ul>
      

      </div>
    </main>
    <footer role="contentinfo" class="thtrm-footer thtrm-footer--slim">
  <div class="thtrm-footer-text">
    <img class="thtrm-footer-logo" alt="thoughtram brain" src="/images/thoughtram-brain-white.png">
    <p>This website was created in collaboration with <a href="http://twitter.com/timche_" title="Tim Cheung on Twitter"><strong>Tim Cheung</strong></a> and <a href="http://twitter.com/tim_hartmann_" title="Tim Hartmann on Twitter"><strong>Tim Hartmann</strong></a>.</p>
    <p ><a href="http://thoughtram.io/code-of-conduct.html" title="Code of Conduct">Code of Conduct</a> &bullet; <a href="http://thoughtram.io/imprint.html" title="Legal Notice">Legal notice</a></p>
    <p class="thtrm-footer-bottom">&copy; 2014-2017 thoughtram GmbH</p>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-51360648-2', 'auto');
ga('send', 'pageview');

var form = document.getElementById('search-form');
var eventCta = document.getElementById('event-cta');

if (eventCta) {

  eventCta.addEventListener('click', function (event) {
    event.preventDefault();

    setTimeout(clickLink, 1000);

    function clickLink() {
      window.location.replace(eventCta.getAttribute('href'));
    }

    ga('send', 'event', {
      eventCategory: 'Event Link',
      eventAction: 'click',
      eventLabel: eventCta.getAttribute('title'),
      hitCallback: clickLink
    });
  });
}

if (form) {

  var searchTerm = document.getElementById('search-term');

  form.addEventListener('submit', function(event) {
    event.preventDefault();

    var formSubmitted = false;

    setTimeout(submitForm, 1000);

    function submitForm() {
      if (!formSubmitted) {
        formSubmitted = true;
        form.submit();
      }
    }

    ga('send', 'event', {
      eventCategory: 'Search Form',
      eventAction: 'submit',
      eventLabel: searchTerm.value,
      hitCallback: submitForm
    });
  });
}
</script>



    <script src="/scripts/stickyfill.js"></script>
    <script src="/scripts/linkjuice/dist/linkjuice.js"></script>
    <script src="/scripts/main.js"></script>
  </body>
</html>
