




<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="In this article you'll learn how to upgrade your Angular 1 applications to Angular 2 using ngUpgrade.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="thoughtram">
    <title>Upgrading Angular apps using ngUpgrade by thoughtram</title>
    <meta name="google-site-verification" content="o9eGPEgIETEqYGombq7NiQuBIB_qa6gz1yAL7PxKyK0">

    <!-- Add to homescreen for Chrome on Android -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#4D8799">
    <link rel="icon" sizes="192x192" href="/images/touch/chrome-touch-icon-192x192.png">

    <!-- Add to homescreen for Safari on iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="thoughtram">
    <link rel="apple-touch-icon" href="/images/touch/apple-touch-icon.png">

    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <meta name="msapplication-TileImage" content="/images/touch/ms-touch-icon-144x144-precomposed.png">
    <meta name="msapplication-TileColor" content="#4D8799">

    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Upgrading Angular apps using ngUpgrade">
    <meta property="og:description" content="In this article you'll learn how to upgrade your Angular 1 applications to Angular 2 using ngUpgrade.">
    <meta property="og:url" content="http://blog.thoughtram.io/angular/2015/10/24/upgrading-apps-to-angular-2-using-ngupgrade.html">
    <meta property="og:site_name" content="Articles by thoughtram">
    <meta property="og:image" content="http://blog.thoughtram.io">
    <meta property="og:publisher" content="http://www.facebook.com/thoughtram">

    <meta property="twitter:card" content="summary">
    <meta property="twitter:title" content="Upgrading Angular apps using ngUpgrade">
    <meta property="twitter:site" content="thoughtram Blog">

    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="/css/main.css" type="text/css">
  </head>
  <body class="sub-site">
    <!-- Add your site or app content here -->

    <!--[if lt IE 10]>
        <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->

    <header class="thtrm-header" role="banner">
      <div class="thtrm-header-bar">
        <div class="thtrm-constraint">
          <a href="http://thoughtram.io" class="thtrm-header-logo-link" title="thoughtram.io Start Page"><h1 class="thtrm-header-logo">thoughtram</h1></a>
          <div class="thtrm-header-menu-wrapper">
            <span role="button" tabindex="0" class="thtrm-header-menu-label">Menu</span>
            <ul class="thtrm-header-menu">
              <li><a title="Training" class="thtrm-header-menu-item" href="http://thoughtram.io/training.html">Training</a></li>
              <li><a title="Code Review" class="thtrm-header-menu-item" href="http://thoughtram.io/code-review.html">Code Review</a></li>
              <li><a title="Casts" class="thtrm-header-menu-item " href="http://casts.thoughtram.io">Casts</a></li>
              <li><a title="Blog" class="thtrm-header-menu-item" href="/">Blog</a></li>
            </ul>
          </div>
        </div>
      </div>
    </header>

    <main role="main" class="thtrm-main">
    <div class="thtrm-banner" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%), url('/images/banner/fallback.jpeg');">
        <hgroup class="thtrm-banner-container">
          <div class="thtrm-constraint thtrm-constraint--slim">
            <h2 class="thtrm-banner-text">Upgrading Angular apps using ngUpgrade</h2>
            <span>by <a href="http://twitter.com/" title="Pascal Precht on Twitter">Pascal Precht</a> on Oct 24, 2015, last updated on Dec 18, 2016<br>20 minute read</span>

          </div>
        </hgroup>
      </div>
      <div class="thtrm-constraint thtrm-constraint--slim">

        <div class="thtrm-article">
          <section class="thtrm-ad thtrm-section thtrm-section--is-promo is-sticky">
  <img width="100" src="/images/angular2-shield-inverse.svg">
  <h3 class="thtrm-section-headline">Angular Master Class in Denmark</h3>
  <p class="thtrm-section-text">Join our upcoming public training! </p>
  <a href="https://www.eventbrite.de/e/angular-master-class-denmark-tickets-34271504994?aff=blogAd" title="Angular Master Class in Denmark" id="event-cta" class="thtrm-layout-divider-cta">Get a ticket <strong>&rarr;</strong></a>
</section>


          
          <p style="background-color: lightgoldenrodyellow; border: solid 2px #f9dead; padding: 1em; text-align: center; border-radius: 0.3em;">Contents are based on Angular version <strong>>= 2.x</strong> unless explicitely stated differently.</p>
          

          <p>Upgrading an existing AngularJS application to Angular &gt;= 2.x is surely one of the most interesting topics when it comes to Angular. A long time it has been unclear what a dedicated upgrade path will actually look like, since Angular was still in alpha state and APIs weren’t stable yet, which makes it hard to “assume” where things will go and what’s the best way to get there.</p>

<p>Earlier this year however, the Angular team has made an <a href="http://angularjs.blogspot.de/2015/08/angular-1-and-angular-2-coexistence.html">official announcement</a> in which they talk about what are the available upgrade strategies and what things of both frameworks have to interoperate in order to run them side-by-side on the same website. While the blog post is rather a kind of birds-eye view where no code is shown, a dedicated <a href="https://docs.google.com/document/d/1xvBZoFuNq9hsgRhPPZOJC-Z48AHEbIBPlOCBTSD8m0Y">design document</a> has been created that gives a more concrete idea on what the APIs will look like.</p>

<p>Meanwhile, first implementations of <code>ngUpgrade</code> have landed in the code base and it’s time to start digging into it. In this article we’re going to explore what we can do to prepare for an upgrade, and of course how we eventually use <code>ngUpgrade</code> to upgrade our Angular application.</p>

<div class="thtrm-toc is-sticky">
  <h3 class="no_toc" id="table-of-contents">TABLE OF CONTENTS</h3>
<ul id="markdown-toc">
  <li><a href="#why-upgrade" id="markdown-toc-why-upgrade">Why upgrade?</a></li>
  <li><a href="#changes-in-angular" id="markdown-toc-changes-in-angular">Changes in Angular</a></li>
  <li><a href="#preparing-for-upgrade" id="markdown-toc-preparing-for-upgrade">Preparing for upgrade</a></li>
  <li><a href="#upgrade-strategies" id="markdown-toc-upgrade-strategies">Upgrade Strategies</a></li>
  <li><a href="#upgrading-using-ngupgrade" id="markdown-toc-upgrading-using-ngupgrade">Upgrading using ngUpgrade</a></li>
  <li><a href="#downgrading-angular-2x-components" id="markdown-toc-downgrading-angular-2x-components">Downgrading Angular 2.x components</a></li>
  <li><a href="#upgrading-angular-1-components" id="markdown-toc-upgrading-angular-1-components">Upgrading Angular 1 components</a></li>
  <li><a href="#adding-angular-providers" id="markdown-toc-adding-angular-providers">Adding Angular Providers</a></li>
  <li><a href="#upgrading-angular-1-providers" id="markdown-toc-upgrading-angular-1-providers">Upgrading Angular 1 Providers</a></li>
  <li><a href="#downgrading-angular-2x-providers" id="markdown-toc-downgrading-angular-2x-providers">Downgrading Angular 2.x Providers</a></li>
  <li><a href="#conclusion" id="markdown-toc-conclusion">Conclusion</a></li>
</ul>

</div>

<h2 id="why-upgrade">Why upgrade?</h2>

<p>One thing that seems to be a bit left out when people get scared that they can’t upgrade to Angular &gt;= 2.x for various reasons, is to think about if an upgrade is needed in the first place. Of course, Angular &gt;= 2.x is the next major version of the framework and it will surely be the version we want to go with when building web applications in the future.</p>

<p>However, that doesn’t mean that our existing Angular 1 applications aren’t good enough anymore to survive the next generation of the web. It’s not that once Angular 2.x is out, our Angular 1 applications immediately stop working. We still have a massive amount of websites out there that seem to be outdated, old and slow. Believe it or not, even if those websites are over 10 years old, they still work. That’s the nice thing about the web, nothing is as backwards compatible because no one wants to break the web, right?</p>

<p>So before we think about going through the process upgrading we should really ask ourselves why we want to do it and if the applications we’ve built so far are really in a state that they need this upgrade.</p>

<p>Nonetheless there are some very strong arguments why one wants to upgrade and here are just a few of them:</p>

<ul>
  <li>
    <p><strong>Better Performance</strong> - Angular comes with a way faster change detection, template precompilation, faster bootstrap time, view caching and plenty other things that make the framework freakin’ fast.</p>
  </li>
  <li>
    <p><strong>Server-side Rendering</strong> - The next version of Angular has been split up into two parts, an application layer and a render layer. This enables us to run Angular in other environments than the browser like Web Workers or even servers.</p>
  </li>
  <li>
    <p><strong>More powerful Templating</strong> - The new template syntax is statically analyzable as discussed <a href="/angular/2015/08/11/angular-2-template-syntax-demystified-part-1.html">here</a>, removes many directives and integrates better with Web Components and other elements.</p>
  </li>
  <li>
    <p><strong>Better Ecosystem</strong> - Of course, at the time of writing this article, this is not true. But the Angular ecosystem will eventually be better and more interesting to us in the future.</p>
  </li>
</ul>

<p>There are surely more reasons why Angular &gt;= 2.x is better than Angular 1.x, but keep in mind that we’re talking about the motivation for upgrade here. Let’s talk about how we can prepare for an actual upgrade.</p>

<h2 id="changes-in-angular">Changes in Angular</h2>

<p>In order to upgrade, we need to understand in what ways Angular &gt;= 2.x is different. Unfortunately, covering the bigger differences between both version of the framework is out of the scope of this article. However, if you’re entirely new to Angular, you might want to checkout our project <a href="/exploring-angular-2">Exploring Angular</a> and get your feet wet.</p>

<p>Here’s a list of changes that are crucial when thinking about upgrading:</p>

<ul>
  <li><strong>Components</strong> - Components are the new building blocks when creating applications with Angular. Almost everything is a component, even our application itself.</li>
  <li><strong>Inputs/Outputs</strong> - Components communicate via inputs and outputs, if they run in the Browser, these are element properties and events. Our article on <a href="/angular/2015/08/11/angular-2-template-syntax-demystified-part-1.html">demystifying Angular’s Template syntax</a> explains how they work.</li>
  <li><strong>Content Projection</strong> - Basically the new transclusion, but more aligned with the Web Components standard.</li>
  <li><strong>Dependency Injection</strong> - Instead of having a single injector for our entire application, in Angular each component comes with its own injector. We have a dedicated <a href="/angular/2015/05/18/dependency-injection-in-angular-2.html">article</a> on that too.</li>
</ul>

<p>Of course, there are way more things in Angular that will change or be added to the framework, such as <a href="/angular/2016/06/14/routing-in-angular-2-revisited.html">Routing</a>, Forms, the Http layer and more.</p>

<p><strong>How do we get there?</strong></p>

<p>After doing tons of research at thoughtram with <a href="http://twitter.com/cburgdorf">Christoph</a> we realised, that the entire upgrade process can basically be categorized in two phases: Preparation and Upgrade.</p>

<p><img src="/assets/upgrade-2-phases-3.svg" /></p>

<p><strong>Preparation</strong></p>

<p>This is the phase that we could start off today. What can we do today to make the upgrade process later on easier? This includes several things like how we structure our application, which tools can we use or maybe even a language upgrade.</p>

<p><strong>Upgrade</strong></p>

<p>The phase of running both frameworks side-by-side. This is where <code>ngUpgrade</code> comes into play to make A1 and A2 components interoperable. Keep in mind that the goal of this phase is to stay in it as little as possible, since running both frameworks on the same website is surely not ideal.</p>

<h2 id="preparing-for-upgrade">Preparing for upgrade</h2>

<p>Let’s discuss what we can do today to prepare for an actual upgrade.</p>

<p><strong>Layer application by feature or component</strong></p>

<p>Oldie but goldie. We still see applications using a project structure where all directives go into <code>app/directives</code>, services go into <code>app/services</code>, controllers into <code>app/controllers</code> and so on and so forth. You get the idea. While this totally works in smaller applications, it doesn’t really take us far when it comes to upgrading. We might want to upgrade component by component. Having an application layered by type rather than by feature/component, makes it harder to extract parts of the code base to upgrade it.</p>

<p>We should rather go with something like:</p>

<div class="highlight"><pre><code class="language-sh" data-lang="sh">app
|- components
  |- productDetail
  | |- productDetail.js
  | |- productDetail.css
  | |- productDetail.html
  | |- productDetail.spec.js
  |- productList
  |- checkout
  |- wishlist</code></pre></div>

<p>This structure allows us to take e.g. <code>productDetail</code> and upgrade it to Angular &gt;= 2.x to integrate it back into the application later on. We don’t have to worry if there’s anything else related to <code>productDetail</code> in the code base that we might forget, because everything is in one place.</p>

<p><strong>Use .service() instead of .factory()</strong></p>

<p>If we plan to not only upgrade the framework, but also the language in which we’re writing our application, we should definitely consider to use <code>.service()</code> instead of <code>.factory()</code> in all the cases where a service can be potentially a class. In Angular, a service is also just a class, so this seems like a logical thing to do. For more information on why <code>.service()</code> might be a better fit, read <a href="/angular/2015/07/07/service-vs-factory-once-and-for-all.html">this article</a>.</p>

<p><strong>Write new components in ES2015 or TypeScript</strong></p>

<p>This is an interesting one. When we saw Angular code the very first time, some of us were scared because all of a sudden there were classes and decorators. Despite the fact that we <strong>don’t</strong> have to write our Angular apps in TypeScript (as explained in <a href="/angular/2015/05/09/writing-angular-2-code-in-es5.html">this article</a>), ES2015 is the next standardized version, which means we will write it sooner or later anyways.</p>

<p>We wrote about <a href="/angularjs/es6/2015/01/23/exploring-angular-1.3-using-es6.html">how to write Angular in ES2015</a> today and if we do plan to upgrade but can’t do it right now, we should definitely write our <strong>new</strong> components in ES2015 or TypeScript.</p>

<p>That being said, <strong>it doesn’t really make sense to upgrade existing code to ES2015 or TypeScript</strong>. Even though it seems to be a logical step in preparation for upgrade, it doesn’t help us in any way to take the existing and large code base and upgrade it to ES2015 or TypeScript first, before we upgrade the application to Angular &gt;=2.x.</p>

<p>If we have to upgrade to Angular 2.x, it probably makes more sense to just rewrite component by component, without touching the existing code base. But this of course depends on how big our application is.</p>

<p>Again, this is just a language upgrade and it doesn’t really help with the upgrade itself, however, it helps us and our team to get used to the new languages features as we’re building components with it.</p>

<p><strong>Use decorators in Angular 1?</strong></p>

<p>Of course, we can take our code base closer to what Angular 2.x code would look like, by upgrading our language to TypeScript and use e.g. Decorators that have specifically been created for Angular 1. There are plenty community projects out there, some of them are <a href="https://github.com/hannahhoward/a1atscript">a1atscript</a>, <a href="https://github.com/pbastowski/angular2-now">angular2-now</a>, <a href="https://github.com/mikeryan52/angular-decorators">angular-decorators</a> and <a href="https://github.com/eaze/ng-classy">ng-classy</a>.</p>

<p>They try solve the same problem, which is adding semantically useful decorators to Angular 1. But do they really help? <strong>I don’t think so</strong>. They might improve the developer experience because all of a sudden we can use nice decorators that generate code for us, however, they don’t help when it comes to upgrading an application to Angular &gt;= 2.x. One project, <a href="https://github.com/ngUpgraders/ng-forward">ng-forward</a>, tries to make the exact same Angular syntax available in Angular 1.x.</p>

<p>This <em>can</em> be helpful to some extent since you and your team are getting familiar with how to write apps in Angular 2.x while writing Angular 1.x code. On the other hand, it could also be confusing when trying to squeeze Angular 2.x concepts and syntax into the Angular 1.x world. We’ll see how practical it is once projects are starting to use it.</p>

<h2 id="upgrade-strategies">Upgrade Strategies</h2>

<p>Now that we know what we can do to prepare for an upgrade, let’s take a look at the different upgrade strategies available to see which one makes more sense to us.</p>

<p>There are basically two strategies:</p>

<ul>
  <li><strong>Big Bang</strong> - Start a spike in Angular &gt;= 2.x and replace entire app once done</li>
  <li><strong>Incremental</strong> - Upgrade existing app once service or component at a time</li>
</ul>

<p><strong>Which one should we use?</strong></p>

<p>This really depends! If our application is rather small a big bang rewrite is probably the easiest and fastest way to upgrade. If our application is rather large and it’s deployed continuesly, we can’t just upgrade the whole thing at once. We need a way to do it step by step, component by component, service by service. This is where the incremental upgrade comes into play.</p>

<p>In the end it’s really a matter of how much time we have available to process the upgrade. We will focus on incremental upgrade, since this is what the majority of developers want to understand and see how it works.</p>

<h2 id="upgrading-using-ngupgrade">Upgrading using ngUpgrade</h2>

<p>In order to run both frameworks side-by-side and make components interoperable, the Angular projects comes with a module <code>ngUpgrade</code>. The module basically acts as an adapter facade, so we don’t really feel that there are two frameworks running side-by-side.</p>

<p>For this to work, four things need to interoperate:</p>

<ul>
  <li><strong>Dependency Injection</strong> - Exposing Angular services into Angular 1.x components and vice-versa.</li>
  <li><strong>Component Nesting</strong> - Angular 1 directives can be used in Angular 2.x components and Angular 2.x components can used Angular 1 directives</li>
  <li><strong>Content Projection / Transclusion</strong> - Angular 1 components transclude Angular 2.x components and Angular 2.x component project Angular 1 directives</li>
  <li><strong>Change Detection</strong> - Angular 1 scope digest and change detectors in Angular &gt;= 2.x are interleaved</li>
</ul>

<p>With these four things being interoperable, we can already start upgrading our applications component by component. Routing is another part that can help but is not necessarily mandatory, since we can totally stick with any Angular 1 routing system while upgrading.</p>

<p><strong>The typical upgrade process</strong></p>

<p>Here’s what a typical upgrade process would look like:</p>

<ul>
  <li>Include Angular and upgrade module</li>
  <li>Pick component to upgrade and change its controller and template Angular 2.x syntax (this is now an Angular 2.x component)</li>
  <li>Downgrade Angular 2.x component to make it run in Angular 1.x app</li>
  <li>Pick a service to upgrade, this usually requires little amount of change (especially if we’re on ES2015)</li>
  <li>Repeat step 2 and 3 (and 4)</li>
  <li>Replace Angular 1 bootstrap with Angular 2.x bootstrap</li>
</ul>

<p>Let’s use <code>ngUpgrade</code> to upgrade our components to Angular 2.x!</p>

<p><strong>Bootstrapping with ngUpgrade</strong></p>

<p>The first thing we need to do is to upgrade our Angular 1 application with <code>ngUpgrade</code>. Whenever we upgrade an Agular app, we <strong>always</strong> have an Angular 1.x module being bootstrap at root level. This means, during the process of upgrade, Angular components are always bootstrap inside Angular 1.x components.</p>

<p>Let’s start with an app we want to upgrade;</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'myApp'</span><span class="p">,</span> <span class="p">[]);</span></code></pre></div>

<p>Plain old Angular 1 module. Usually, this module is bootstrapped using the <code>ng-app</code> attribute, but now we want to bootstrap our module using <code>ngUpgrade</code>. We do that by removing the <code>ng-app</code> attribute from the HTML, create an <code>ngUpgrade</code> adapter from the upgrade module, and call <code>bootstrap()</code> on it with <code>myApp</code> as module dependency:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">import</span> <span class="p">{</span> <span class="nx">UpgradeAdapter</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'@angular/upgrade'</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">adapter</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">UpgradeAdapter</span><span class="p">();</span>
<span class="kd">var</span> <span class="nx">app</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s1">'myApp'</span><span class="p">,</span> <span class="p">[]);</span>

<span class="nx">adapter</span><span class="p">.</span><span class="nx">bootstrap</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="p">[</span><span class="s1">'myApp'</span><span class="p">]);</span></code></pre></div>

<p>Cool, our app is now bootstrapped using <code>ngUpgrade</code> and we can start mixing Angular 1.x components with Angular 2.x components. However, in a real world application, you want to create an instance of <code>UpgradeAdapter</code> in a separate module and import it where you need it. This leads to cleaner code when upgrading across your application.</p>

<h2 id="downgrading-angular-2x-components">Downgrading Angular 2.x components</h2>

<p>Let’s upgrade our first component to Angular 2.x and use it in our Angular 1.x application. Here we have a <code>productDetail</code> component that needs to be upgraded:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">app</span><span class="p">.</span><span class="nx">component</span><span class="p">(</span><span class="s1">'productDetail'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="na">bindings</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">product</span><span class="p">:</span> <span class="s1">'='</span>
  <span class="p">},</span>
  <span class="na">controller</span><span class="p">:</span> <span class="s1">'ProductDetailController'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="err">`</span>
    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">$ctrl</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}}</span><span class="o">&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">$ctrl</span><span class="p">.</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>  <span class="err">`</span>
<span class="p">});</span></code></pre></div>

<p>Upgrading this to Angular 2.x looks something like this:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'product-detail'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="err">`</span>
    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">product</span><span class="p">.</span><span class="nx">name</span><span class="p">}}</span><span class="o">&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">{{</span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">}}</span><span class="o">&lt;</span><span class="sr">/p</span><span class="err">&gt;
</span>  <span class="err">`</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">ProductDetail</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">Input</span><span class="p">()</span> <span class="nx">product</span><span class="err">:</span> <span class="nx">Product</span><span class="p">;</span>
<span class="p">}</span></code></pre></div>

<p><strong>Note</strong>: You might want to define this component in a separate file, for simplicity sake we defined it in place.</p>

<p>Perfect! But how do we get this Angular component into our Angular 1.x application? The <code>UpgradeAdapter</code> we’ve created comes with a method <code>downgradeNg2Component()</code>, which takes an Angular component and creates an Angular 1.x directive from it. Let’s use our Angular component in Angular 1.x world.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">app</span><span class="p">.</span><span class="nx">directive</span><span class="p">(</span><span class="s1">'productDetail'</span><span class="p">,</span>
  <span class="nx">adapter</span><span class="p">.</span><span class="nx">downgradeNg2Component</span><span class="p">(</span><span class="nx">ProductDetail</span><span class="p">));</span></code></pre></div>

<p>Yay! That’s it! The adapter will bootstrap this component from within the Angular 1 template where it’s used.</p>

<p>But wait, our Angular 2.x component is just an Angular 1.x component eventually? Yes and no. The directive is controlled by Angular 1.x, but the component’s view will be controller by Angular &gt;= 2.x. This means the resulting Angular 1.x components takes advantage of Angular 2.x features and performance.</p>

<h2 id="upgrading-angular-1-components">Upgrading Angular 1 components</h2>

<p>There might be cases where one component has already been upgraded to Angular &gt;= 2.x, but it still uses Angular 1.x directives in its template. <code>ngUpgrade</code> allows us to use Angular 1.x directives in Angular 2.x components by upgrading them using <code>upgradeNg1Component()</code>.</p>

<p>Let’s say we continued upgrading our application and have a <code>ProductList</code> component like this:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">@</span><span class="nx">Component</span><span class="p">({</span>
  <span class="na">selector</span><span class="p">:</span> <span class="s1">'product-list'</span><span class="p">,</span>
  <span class="na">template</span><span class="p">:</span> <span class="err">`</span>
    <span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span><span class="nx">Product</span> <span class="nx">List</span><span class="o">&lt;</span><span class="sr">/h2</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="nx">ol</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">li</span> <span class="o">*</span><span class="nx">ngFor</span><span class="o">=</span><span class="s2">"let product of products"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">product</span><span class="o">-</span><span class="nx">list</span><span class="o">-</span><span class="nx">item</span> <span class="p">[</span><span class="nx">product</span><span class="p">]</span><span class="o">=</span><span class="s2">"product"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="sr">/product-list-item</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/li</span><span class="err">&gt;
</span>    <span class="o">&lt;</span><span class="sr">/ol</span><span class="err">&gt;
</span>  <span class="err">`</span>
<span class="p">})</span>
<span class="kr">class</span> <span class="nx">ProductList</span> <span class="p">{</span>
  <span class="err">@</span><span class="nx">Input</span><span class="p">()</span> <span class="nx">products</span><span class="err">:</span> <span class="nx">Product</span><span class="p">[];</span>
  <span class="p">...</span>
<span class="p">}</span></code></pre></div>

<p><code>&lt;product-list-item&gt;</code> is a component that hasn’t been ported to Angular 2.x yet and maybe can’t even for some reason. It needs to be upgraded but how do we get there? As you can see, there’s a <code>directives</code> property in the <code>@Component()</code> metadata. This property defines which directives are used in the component’s template. What we need is a way to add <code>&lt;product-list-item&gt;</code> there too.</p>

<p><code>upgradeNg1Component()</code> enables us to do exactly that. It takes the name of a directive that has been registered somewhere on our Angular 1 module and upgrades it to an Angular 2.x component. Here’s what it looks like:</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">@</span><span class="nx">NgModule</span><span class="p">({</span>
  <span class="na">imports</span><span class="p">:</span> <span class="p">[</span><span class="nx">BrowserModule</span><span class="p">],</span>
  <span class="na">declarations</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">AppComponent</span><span class="p">,</span>
    <span class="nx">ProductList</span><span class="p">,</span>
    <span class="nx">adapter</span><span class="p">.</span><span class="nx">upgradeNg1Component</span><span class="p">(</span><span class="s1">'productListItem'</span><span class="p">)</span>
  <span class="p">],</span>
  <span class="p">...</span>
<span class="p">})</span>
<span class="kr">export</span> <span class="kr">class</span> <span class="nx">AppModule</span> <span class="p">{}</span></code></pre></div>

<p>All we need to do is to downgrade <code>ProductList</code> item and we can use it right away!</p>

<h2 id="adding-angular-providers">Adding Angular Providers</h2>

<p>Upgrading components is probably the most crucial part in the entire upgrade process. Sometimes however, components have service dependencies which need to work in both worlds too. Luckily, <code>ngUpgrade</code> provides APIs for that.</p>

<p>Let’s say our <code>ProductDetail</code> component, already upgraded to Angular &gt;= 2.x, has a <code>ProductService</code> dependency.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">ProductService</span> <span class="p">{</span>

<span class="p">}</span>

<span class="err">@</span><span class="nx">Component</span><span class="p">()</span>
<span class="kr">class</span> <span class="nx">ProductDetail</span> <span class="p">{</span>
  <span class="nx">constructor</span><span class="p">(</span><span class="nx">productService</span><span class="err">:</span> <span class="nx">ProductService</span><span class="p">)</span> <span class="p">{</span>

  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p>In Angular &gt;= 2.x, we have to add a provider configuration for the component’s injector, but since we don’t bootstrap using Angular 2.x, there’s no way to do so. <code>ngUpgrade</code> allows us to add a provider using the <code>addProvider()</code> method to solve this scenario.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">adapter</span><span class="p">.</span><span class="nx">addProvider</span><span class="p">(</span><span class="nx">ProductService</span><span class="p">);</span></code></pre></div>

<p>That’s all we need to do!</p>

<h2 id="upgrading-angular-1-providers">Upgrading Angular 1 Providers</h2>

<p>Let’s say our <code>ProductService</code> depends on another lower level <code>DataService</code> to communicate with a remote server. <code>DataService</code> is already implemented in our Angular 1 application but not yet upgraded to Angular 2.x.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">ProductService</span> <span class="p">{</span>

  <span class="nx">constructor</span><span class="p">(</span><span class="err">@</span><span class="nx">Inject</span><span class="p">(</span><span class="s1">'DataService'</span><span class="p">)</span> <span class="nx">dataService</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">'DataService'</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="p">...</span>
<span class="p">});</span></code></pre></div>

<p>As you can see, we’re using <code>@Inject</code> to specify the provider token for <code>DataService</code>, since we don’t have a <code>DataService</code> type. If this is unclear, you might want to read our articles on <a href="/angular/2015/05/18/dependency-injection-in-angular-2.html">DI in Angular</a>.</p>

<p>However, there’s no provider for <code>'DataService'</code> in Angular 2.x world yet. Let’s make it available using <code>upgradeNg1Provider()</code>.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">adapter</span><span class="p">.</span><span class="nx">upgradeNg1Provider</span><span class="p">(</span><span class="s1">'DataService'</span><span class="p">);</span></code></pre></div>

<p>Boom! We can make it even better. Let’s assume our Angular 1 service has already been written as class.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">DataService</span> <span class="p">{</span>

<span class="p">}</span>

<span class="nx">app</span><span class="p">.</span><span class="nx">service</span><span class="p">(</span><span class="s1">'DataService'</span><span class="p">,</span> <span class="nx">DataService</span><span class="p">);</span></code></pre></div>

<p>We can use that class as type and token for dependency injection in Angular 2.x. All we have to do, is to upgrade our service with that token.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">adapter</span><span class="p">.</span><span class="nx">upgradeNg1Provider</span><span class="p">(</span><span class="s1">'DataService'</span><span class="p">,</span> <span class="p">{</span><span class="na">asToken</span><span class="p">:</span> <span class="nx">DataService</span><span class="p">});</span></code></pre></div>

<p>Now we can inject it using plain old type annotations.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="err">@</span><span class="nx">Injectable</span><span class="p">()</span>
<span class="kr">class</span> <span class="nx">ProductService</span> <span class="p">{</span>

  <span class="nx">constructor</span><span class="p">(</span><span class="nx">dataService</span><span class="err">:</span> <span class="nx">DataService</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></div>

<p><strong>Note</strong>: We added <code>@Injectable()</code> to our service because TypeScript needs at least one decorator to emit metadata for it. Learn more in our article on <a href="/angular/2015/09/17/resolve-service-dependencies-in-angular-2.html">Injecting Services in Services in Angular</a>.</p>

<h2 id="downgrading-angular-2x-providers">Downgrading Angular 2.x Providers</h2>

<p>Last but not least, we might need to be able to use Angular 2.x services in Angular 1.x components. Guess what, <code>ngUpgrade</code> comes with a <code>downgradeNg2Provider()</code> method.</p>

<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">app</span><span class="p">.</span><span class="nx">factory</span><span class="p">(</span><span class="s1">'ProductService'</span><span class="p">,</span>
  <span class="nx">adapter</span><span class="p">.</span><span class="nx">downgradeNg2Provider</span><span class="p">(</span><span class="nx">ProductService</span><span class="p">));</span></code></pre></div>

<h2 id="conclusion">Conclusion</h2>

<p><code>ngUpgrade</code> provides many useful APIs and is a big step forward when it comes to truly upgrading an application from Angular 1 to Angular &gt;= 2.x. At <a href="http://angularconnect.com">AngularConnect</a> we gave a workshop on upgrading and we’ve open sourced a <a href="https://github.com/thoughtram/angular-upgrade-demo">repository</a> that shows all the steps we’ve been through, from preparation to upgrade. Make sure to check out the <code>steps</code> branch.</p>

<p>Hopefully this article made a bit more clear what this whole upgrade story is all about!</p>


          




        </div>

        <div class="thtrm-subscriber">
  <h3>Get updates on new articles and trainings.</h3>
  <p>Join over 1400 other developers who get our content first.</p>
  <form action="//thoughtram.us8.list-manage.com/subscribe/post?u=dfbb1507fbced5a20d9dc5698&amp;id=731f22cdca" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" target="_blank" novalidate>
    <label for="mce-EMAIL"></label>
    <input type="email" value="" name="EMAIL" placeholder="Your email address..." required>
    <div style="position: absolute; left: -5000px;"><input type="text" name="b_dfbb1507fbced5a20d9dc5698_731f22cdca" tabindex="-1" value=""></div>
    <input type="submit" value="Subscribe" name="subscribe" class="thtrm-cta thtrm-cta--small">
  </form>
</div>



        <div class="thtrm-social-links">
            <!-- Sharingbutton Facebook -->
            <a class="resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.thoughtram.io/angular/2015/10/24/upgrading-apps-to-angular-2-using-ngupgrade.html" target="_blank" aria-label="Share on Facebook">
              <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M18.768,7.465H14.5V5.56c0-0.896,0.594-1.105,1.012-1.105s2.988,0,2.988,0V0.513L14.171,0.5C10.244,0.5,9.5,3.438,9.5,5.32 v2.145h-3v4h3c0,5.212,0,12,0,12h5c0,0,0-6.85,0-12h3.851L18.768,7.465z"/>
                    </g>
                </svg>
                </div>Share on Facebook</div>
            </a>

            <!-- Sharingbutton Twitter -->
            <a class="resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Upgrading%20Angular%20apps%20using%20ngUpgrade&amp;url=http://blog.thoughtram.io/angular/2015/10/24/upgrading-apps-to-angular-2-using-ngupgrade.html" target="_blank" aria-label="Share on Twitter">
              <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M23.444,4.834c-0.814,0.363-1.5,0.375-2.228,0.016c0.938-0.562,0.981-0.957,1.32-2.019c-0.878,0.521-1.851,0.9-2.886,1.104 C18.823,3.053,17.642,2.5,16.335,2.5c-2.51,0-4.544,2.036-4.544,4.544c0,0.356,0.04,0.703,0.117,1.036 C8.132,7.891,4.783,6.082,2.542,3.332C2.151,4.003,1.927,4.784,1.927,5.617c0,1.577,0.803,2.967,2.021,3.782 C3.203,9.375,2.503,9.171,1.891,8.831C1.89,8.85,1.89,8.868,1.89,8.888c0,2.202,1.566,4.038,3.646,4.456 c-0.666,0.181-1.368,0.209-2.053,0.079c0.579,1.804,2.257,3.118,4.245,3.155C5.783,18.102,3.372,18.737,1,18.459 C3.012,19.748,5.399,20.5,7.966,20.5c8.358,0,12.928-6.924,12.928-12.929c0-0.198-0.003-0.393-0.012-0.588 C21.769,6.343,22.835,5.746,23.444,4.834z"/>
                    </g>
                </svg>
                </div>Share on Twitter</div>
            </a>

            <!-- Sharingbutton Google+ -->
            <a class="resp-sharing-button__link" href="https://plus.google.com/share?url=http%3A%2F%2Fblog.thoughtram.io/angular/2015/10/24/upgrading-apps-to-angular-2-using-ngupgrade.html" target="_blank" aria-label="Share on Google+">
              <div class="resp-sharing-button resp-sharing-button--google resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
                <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
                    <g>
                        <path d="M11.366,12.928c-0.729-0.516-1.393-1.273-1.404-1.505c0-0.425,0.038-0.627,0.988-1.368 c1.229-0.962,1.906-2.228,1.906-3.564c0-1.212-0.37-2.289-1.001-3.044h0.488c0.102,0,0.2-0.033,0.282-0.091l1.364-0.989 c0.169-0.121,0.24-0.338,0.176-0.536C14.102,1.635,13.918,1.5,13.709,1.5H7.608c-0.667,0-1.345,0.118-2.011,0.347 c-2.225,0.766-3.778,2.66-3.778,4.605c0,2.755,2.134,4.845,4.987,4.91c-0.056,0.22-0.084,0.434-0.084,0.645 c0,0.425,0.108,0.827,0.33,1.216c-0.026,0-0.051,0-0.079,0c-2.72,0-5.175,1.334-6.107,3.32C0.623,17.06,0.5,17.582,0.5,18.098 c0,0.501,0.129,0.984,0.382,1.438c0.585,1.046,1.843,1.861,3.544,2.289c0.877,0.223,1.82,0.335,2.8,0.335 c0.88,0,1.718-0.114,2.494-0.338c2.419-0.702,3.981-2.482,3.981-4.538C13.701,15.312,13.068,14.132,11.366,12.928z M3.66,17.443 c0-1.435,1.823-2.693,3.899-2.693h0.057c0.451,0.005,0.892,0.072,1.309,0.2c0.142,0.098,0.28,0.192,0.412,0.282 c0.962,0.656,1.597,1.088,1.774,1.783c0.041,0.175,0.063,0.35,0.063,0.519c0,1.787-1.333,2.693-3.961,2.693 C5.221,20.225,3.66,19.002,3.66,17.443z M5.551,3.89c0.324-0.371,0.75-0.566,1.227-0.566l0.055,0 c1.349,0.041,2.639,1.543,2.876,3.349c0.133,1.013-0.092,1.964-0.601,2.544C8.782,9.589,8.363,9.783,7.866,9.783H7.865H7.844 c-1.321-0.04-2.639-1.6-2.875-3.405C4.836,5.37,5.049,4.462,5.551,3.89z"/>
                        <polygon points="23.5,9.5 20.5,9.5 20.5,6.5 18.5,6.5 18.5,9.5 15.5,9.5 15.5,11.5 18.5,11.5 18.5,14.5 20.5,14.5 20.5,11.5  23.5,11.5   "/>
                    </g>
                </svg>
                </div>Share on Google+</div>
            </a>
        </div>

        <h3 class="thtrm-section-headline thtrm-section-headline--with-margin">Author</h3>
        <div class="thtrm-article-author">
          <span class="thtrm-article-author-avatar"><img src="/images/author-pascal.jpg" alt="Picture of Pascal Precht"></span>
          <div class="thtrm-article-author-matter">
            <h4 class="thtrm-article-author-name">Pascal Precht</h4>
            <p class="thtrm-article-author-text">Pascal is a front-end engineer and a Angular Developer Expert nominated by Google. He created the angular-translate module, is an Angular contributor and also part of the Angular Docs Authoring team.</p>
            <p>
              <a class="thtrm-article-author-cta thtrm-article-author-cta-twitter" href="http://twitter.com/PascalPrecht" title="Pascal Precht on Twitter">Twitter</a>
              <a class="thtrm-article-author-cta" href="http://github.com/PascalPrecht" title="Pascal Precht on GitHub">GitHub</a>
            </p>
          </div>
        </div>
      </div>

      <div class="thtrm-constraint">

        
        <h4 class="thtrm-section-headline thtrm-section-headline--with-big-margin thtrm-section-headline--centered">Related Posts</h4>
        <ul class="thtrm-three-column-list thtrm-three-column-list--with-padding">
        
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/05/08/angular-master-class-redux-and-ngrx.html" title="Angular Master Class - Redux and ngrx">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/ngrx_slide_logo.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Angular Master Class - Redux and ngrx</h3>
                <p>Today we're super excited to announce that we finished working on our new Angular Master Class courseware. Read on for...</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/27/three-things-you-didnt-know-about-the-async-pipe.html" title="Three things you didn't know about the AsyncPipe">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/three-things-about-the-async-pipe.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Three things you didn't know about the AsyncPipe</h3>
                <p>This article explains three lesser known features of the AsyncPipe that help us to write better async code.</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/21/using-zones-in-angular-for-better-performance.html" title="Using Zones in Angular for better performance">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/using-zones-in-angular-for-better-performance.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Using Zones in Angular for better performance</h3>
                <p>In this article we'll take a look at how to use Zone APIs to improve our app's performance!</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2017/02/02/making-your-angular-app-fast.html" title="Making your Angular apps fast">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/angular-performance-tips.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Making your Angular apps fast</h3>
                <p>In this article we discuss tips and tricks to make Angular blazingly fast!</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2016/12/27/angular-2-advance-testing-with-custom-matchers.html" title="Testing Angular Directives with Custom Matchers">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/testing-directives-with-custom-matchers2.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Testing Angular Directives with Custom Matchers</h3>
                <p>Deliver terse, DRY, self-documenting unit tests with Angular using custom Jasmine Matchers and  Helper functions.</p>
              </div>
            </a>
          </li>
        
          
          <li>
            <a class="thtrm-article-card" href="/angular/2016/11/28/testing-services-with-http-in-angular-2.html" title="Testing Services with Http in Angular">
              <div class="thtrm-article-card-image" style="background-image: linear-gradient(to bottom, rgba(0,0,0,0) 0%,rgba(0,0,0,0.01) 2%,#29383E 100%),url(/images/banner/testing-services-with-http-in-angular-2.jpg);"></div>
              <div class="thtrm-article-card-content ">
                <h3>Testing Services with Http in Angular</h3>
                <p>Want to learn how to test services in Angular that have an Http dependency? Read more here!</p>
              </div>
            </a>
          </li>
        
        
        </ul>
        

      

      </div>
    </main>
    <footer role="contentinfo" class="thtrm-footer thtrm-footer--slim">
  <div class="thtrm-footer-text">
    <img class="thtrm-footer-logo" alt="thoughtram brain" src="/images/thoughtram-brain-white.png">
    <p>This website was created in collaboration with <a href="http://twitter.com/timche_" title="Tim Cheung on Twitter"><strong>Tim Cheung</strong></a> and <a href="http://twitter.com/tim_hartmann_" title="Tim Hartmann on Twitter"><strong>Tim Hartmann</strong></a>.</p>
    <p ><a href="http://thoughtram.io/code-of-conduct.html" title="Code of Conduct">Code of Conduct</a> &bullet; <a href="http://thoughtram.io/imprint.html" title="Legal Notice">Legal notice</a></p>
    <p class="thtrm-footer-bottom">&copy; 2014-2017 thoughtram GmbH</p>
  </div>
</footer>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-51360648-2', 'auto');
ga('send', 'pageview');

var form = document.getElementById('search-form');
var eventCta = document.getElementById('event-cta');

if (eventCta) {

  eventCta.addEventListener('click', function (event) {
    event.preventDefault();

    setTimeout(clickLink, 1000);

    function clickLink() {
      window.location.replace(eventCta.getAttribute('href'));
    }

    ga('send', 'event', {
      eventCategory: 'Event Link',
      eventAction: 'click',
      eventLabel: eventCta.getAttribute('title'),
      hitCallback: clickLink
    });
  });
}

if (form) {

  var searchTerm = document.getElementById('search-term');

  form.addEventListener('submit', function(event) {
    event.preventDefault();

    var formSubmitted = false;

    setTimeout(submitForm, 1000);

    function submitForm() {
      if (!formSubmitted) {
        formSubmitted = true;
        form.submit();
      }
    }

    ga('send', 'event', {
      eventCategory: 'Search Form',
      eventAction: 'submit',
      eventLabel: searchTerm.value,
      hitCallback: submitForm
    });
  });
}
</script>



    <script src="/scripts/stickyfill.js"></script>
    <script src="/scripts/linkjuice/dist/linkjuice.js"></script>
    <script>
    (function (doc, win) {

      linkjuice.init('.thtrm-article', {
        selector: ['h2', 'h3'],
        icon: ''
      });

      if (win.matchMedia && win.matchMedia('(min-width: 1200px)').matches) {
        var stickyElements = doc.querySelectorAll('.is-sticky');

        for (var i = stickyElements.length - 1; i >= 0; i--) {
          var el = stickyElements[i];

          if (el.classList.contains('thtrm-toc')) {
            el.classList.add('thtrm-toc--sticky');
            el.classList.add('thtrm-toc--faded');
          } 
          if (el.classList.contains('thtrm-ad')) {
            el.classList.add('thtrm-ad--sticky');
            el.classList.add('thtrm-ad--description');
          }

          Stickyfill.add(el);
        }
      }
    }(document, window));
    </script>
  </body>
</html>
